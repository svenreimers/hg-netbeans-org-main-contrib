<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!--
 * 
 *     Copyright © 2003 Sun Microsystems, Inc. All rights reserved.
 *     Use is subject to license terms.
 * 
-->
<html>
<head>
<title>Completing Client-Side Files</title>
<link rel="StyleSheet" href="../../../usersguide/ide.css" type="text/css">
</head>
<body>

<h2>Completing Client-Side Files</h2>

<p>
If you created your client file with the CORBA template, ClientMain,
instead of generating a client-side file with the CORBA wizard, you
must add code to your file. The code you add to your client program
depends on the binding method the program uses:
<ul>
<li>
If your client reads an IOR from a file, you need to add the name of
the file it reads from. Then you can code the
<tt>narrow()</tt> method and server-side method invocations.</li>
<li>
If your client reads an IOR from standard input, the binding code is complete
and you can code the <tt>narrow()</tt> method and invocations of server-side
methods.</li>
<li>
If your client reads an IOR from a naming service, the IOR is obtained
with the <tt>resolve()</tt> method. You just need to code the
<tt>narrow()</tt> method and invocations of server-side methods.</li>
</ul>
</p>

<h3>Coding the Naming Service <tt>resolve()</tt> Method</h3>
<p>
The CORBA <tt>lookup()</tt> method uses the NameComponent object to
construct the name associated with the object reference. This name is
passed to the <tt>resolve()</tt> method, which returns the CORBA
object.  If your client class uses Naming Service Binding, the
generated code does not include the <tt>lookup()</tt> method. To code
the method, you need to know how the server binds itself to the naming
service. The easiest way to generate this code is with the Naming
Service browser, which can read the server's IOR from the naming
service and generate lookup code for you.</p>

<p>
<b>To code the</b> <tt>resolve()</tt> <b>method:</b>

<ol>
<li>
Start the CORBA server program.</li>

<li>
Point the CORBA module's Naming Service browser to the naming service to
which the server program bound the servant instance it created.</li>

<li>
In the Runtime tab of the Explorer, expand the naming service node
to see the subnode that represents the servant instance.</li>

<li>
Right-click the node that represents the servant instance and choose
Copy Client Code.</li> 

<li>
Move to the source Editor (your client class should be open in the editing
window.)</li>

<li>
Locate the following comment in the generated code:</li>
<pre>
 // resolve names with the Naming Service
 // paste code retrieved using the Copy Client/Server Code action 
 // (on the corresponding node in the Naming Service Browser) here
</pre>

<li>
Put your insertion point underneath this line and press CTRL-V. This
shortcut pastes the code that was generated by the Naming Service
browser. The code looks something like this:
<pre>
    String[] client_name_hierarchy = new String [] {"JDK", "Naming"};
</pre>
</li>
</ol>
</p>


<h3>Obtaining the IOR</h3>

<p>
Whichever binding method your client uses, the result is an object of type
<tt>org.omg.CORBA.Object</tt>, named <tt>obj</tt>, which represents
the IOR. For example, clients that read an IOR from a file contain this
<OBJECT classid="java:com.sun.java.help.impl.JHSecondaryViewer">
  <param name="content" value="./objcode.html">
  <param name="viewerActivator" value="javax.help.LinkLabel">
  <param name="viewerStyle" value="javax.help.SecondaryWindow">
  <param name="viewerSize" value="610,460">
  <param name="text" value="code.">
  <param name="textFontFamily" value="SansSerif">
  <param name="textFontSize" value="small">
  <param name="textFontWeight" value="plain">
  <param name="textFontStyle" value="plain">
  <param name="textColor" value="blue">
</OBJECT>
</p>

<p>
In clients that use naming service binding, the IOR is obtained by the
<tt>resolve()</tt> method. See the 
<OBJECT classid="java:com.sun.java.help.impl.JHSecondaryViewer">
  <param name="content" value="./resolvecode.html">
  <param name="viewerActivator" value="javax.help.LinkLabel">
  <param name="viewerStyle" value="javax.help.SecondaryWindow">
  <param name="viewerSize" value="600,380">
  <param name="text" value="code example">
  <param name="textFontFamily" value="SansSerif">
  <param name="textFontSize" value="small">
  <param name="textFontWeight" value="plain">
  <param name="textFontStyle" value="plain">
  <param name="textColor" value="blue">
</OBJECT>
for details. 
</p>

<h3>Coding the <tt>narrow()</tt> Method</h3> 

<p>
To use the IOR, you need to call a <tt>narrow()</tt> method, which
returns the object reference.</p>

<p>
<b>To code the</b> <tt>narrow()</tt> <b>method:</b>
<ol>
<li>
In your generated client file, look for this line of code:
<pre>
 /*interface_name*/ srv = /*interface_name*/Helper.narrow (obj);
</pre>
</li>

<li>
Replace the placeholder with the interface name, including the package
and class that contains it. For example:
<pre>
 helloworld.HelloApp.Hello srv = helloworld.HelloApp.HelloHelper.narrow (obj);
</pre>
</li>

<h3>Adding Client Code</h3>

<p>
You can add code at the end of the client file to call server-side
methods. Look for the comment:
<pre>
// add your client code here
</pre>
and type in your code below that line.
</p>

<h3>Compiling Your Client</h3>
<p>
The last step is to compile together all of the classes related to the
client, including the IDL file:
<ul>
<li>In the Filesystems tab of the Explorer, right-click the node for
the package and select Compile.</li>
</ul>
</p>

<table>
<tr valign="top">
<th colspan=2 align=left>See also</th>
</tr>
<tr valign="top">
<td width="23"></td>
<td><a href="../completing/corba_completing_server.html">Completing Server-Side Files</a>
<br>
<a href="../generating/corba_generating.html">Generating CORBA Files</a>
</td>
</tr>
</table>

<hr>
<small><a href="../credits.html">Legal Notices</a></small></body>
</html>
