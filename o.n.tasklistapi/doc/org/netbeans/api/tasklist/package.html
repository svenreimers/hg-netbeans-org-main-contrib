<!--
   -                 Sun Public License Notice
   - 
   - The contents of this file are subject to the Sun Public License
   - Version 1.0 (the "License"). You may not use this file except in
   - compliance with the License. A copy of the License is available at
   - http://www.sun.com/
   - 
   - The Original Code is NetBeans. The Initial Developer of the Original
   - Code is Sun Microsystems, Inc. Portions Copyright 1997-2002 Sun
   - Microsystems, Inc. All Rights Reserved.
  -->

<html>
<body>
The tasklist API allows modules to register and unregister
Suggestions in the Suggestions window.
<p>
The simple scenario for how to create a suggestion is
as follows:
<ol>
 <li> Obtain a reference to the SuggestionManager:
   <pre>
     SuggestionManager manager = SuggestionManager.getDefault();
   </pre>
   Note: this may return null (in the case where the Suggestions
   module is not available/enabled) so check the return value!
   <p>
 <li> Check to make sure that the type of suggestion you're about
      to add is welcome by the user:
   <pre>
      if (manager.isEnabled(suggestionTypeId) &&
          manager.isObserved(suggestionTypeId)) {
   </pre>
   <p>
 <li> Create a new {@link org.netbeans.api.tasklist.Suggestion}:
   <pre>
      Suggestion suggestion = manager.createSuggestion(suggestionTypeId,
                                    "my suggestion description",
          new SuggestionPerformer() {
            public void perform(Suggestion s) {
               beep();
            }
          }
        <i>(two more methods here, both returning null)</i>
      );
      suggestion.setPriority(SuggestionPriority.HIGH);
   </pre>
  <li> Register the suggestion with the SuggestionManager:
   <pre>
      manager.add(suggestion);
   </pre>
  <li> You also need to register the Suggestion type for this
     suggestion with the system. We used <code>suggestionTypeId</code>
     above; this is just a string with some unique Id, let's say
     "CopyrightCheck".  We need to register this in the module's layer XML
     file:
<pre>
    &lt;folder name="Suggestions"&gt; 
        &lt;folder name="Types"&gt; 
            &lt;file name="copyrightcheck.xml" url="copyrightcheck.xml"/&gt;
        &lt;/folder&gt;
    &lt;/folder&gt;
</pre>
and then the file copyrightcheck.xml in your module (in the same
directory as your layer file) contains something like this:
<pre>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE type PUBLIC "-//NetBeans//DTD suggestion type 1.0//EN" "http://www.netbeans.org/dtds/suggestion-type-1_0.dtd"&gt;
&lt;type
    name='CopyrightCheck'
    description_key='HINT_COPYRIGHT'
    localizing_bundle='com.foo.bar.Bundle'
    icon='nbresloc:/com/foo/bar/copyrightCheck.gif'
/&gt;
</pre>
The DTD referenced above can be 
<a href="doc-files/suggestion-type-1_0.dtd">found here</a>.

 <p>
Then in your Bundle file identified above, add an entry like:
<pre>
    HINT_COPYRIGHT=Copyright Problems
</pre>

</ol>
Done! Obviously, you also have to add a dependency on
the tasklist-api in your module's manifest file:
<pre>
OpenIDE-Module-Module-Dependencies: org.netbeans.api.tasklist/1 > 1.0
</pre>
If you are writing code which needs to add suggestions based on 
the current document in the editor, or based on the current node,
etc., look at the SPI documents for tasklist since there are
convenience classes which will instantiate your code lazily etc.
<p>
So here's what a complete code segment might look like:
<pre>
  String suggestionType = "beepid";
  SuggestionManager mgr = SuggestionManager.getDefault();
  if ((mgr != null) && mgr.isEnabled(suggestionType) &&
      mgr.isObserved(suggestionType)) {
     String summary = "Ring the system bell to annoy others";
     SuggestionPerformer performer = new SuggestionPerformer() {
        public void perform(Suggestion s) {
            beep(); beep(); beep();
        }
        public Object getConfirmation(Suggestion s) {
            return "Ring the system bell 3 times, then quit. Will echo \007.";
        }
     });
     Suggestion s = manager.createSuggestion(suggestionType, summary, performer);
     mgr.add(s);
  }
</pre>
</body>
</html>
