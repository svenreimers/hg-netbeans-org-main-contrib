<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="netbeans" name="contrib/licensechanger">
    <description>Builds, tests, and runs the project org.netbeans.modules.licensechanger</description>
    <property name="licenses-dir" value="${basedir}/../../nbbuild/licenses"/>
    <available file="${licenses-dir}" property="licenses-dir-found"/>
    <property name="licenses-list-file" value="${basedir}/src/org/netbeans/modules/licensechanger/licenses.txt"/>
    <property name="licenses-dest-dir" value="${basedir}/src/org/netbeans/modules/licensechanger/licenses"/>
    <condition property="isUnix">
        <os family="unix"/>
    </condition>
    <condition property="isWindows">
        <os family="windows"/>
    </condition>

    <import file="../../nbbuild/templates/projectized.xml"/>

    <target name="-release.files" depends="copy-wizard-lib, projectized.-release.files"/>

    <target name="copy-wizard-lib" description="copy-wizard-library">
        <mkdir dir="${basedir}/release/modules/ext"/>
        <copy file="${basedir}/../o.yourorghere.wizard2/release/modules/ext/wizard.jar"
            todir="${basedir}/release/modules/ext"/>
    </target>

    <target name="build-init" depends="copy-licenses,projectized.build-init"/>

    <target name="clean" depends="projectized-common.clean">
        <delete dir="${licenses-dest-dir}"/>
        <delete file="${licenses-list-file}"/>
    </target>

    <target name="copy-licenses" depends="create-license-list" description="Copy license files">
        <fail unless="licenses-dir-found">
            Could not find ${licenses-dir}
        </fail>
        <mkdir dir="${licenses-dest-dir}"/>
        <copy todir="${licenses-dest-dir}">
            <fileset dir="${basedir}/../../nbbuild/licenses">
                <include name="*"/>
            </fileset>
        </copy>
    </target>

    <target name="create-license-list" depends="create-license-list-unix,create-license-list-windows" description="Create a list of license files"/>

    <target name="create-license-list-unix" if="isUnix">
        <fail>Not implemented</fail>
    </target>

    <target name="create-license-list-windows" if="isWindows">
        <exec executable="cmd" dir="${licenses-dir}" output="${licenses-list-file}">
            <arg value="/c"/>
            <arg value="dir"/>
            <arg value="/b"/>
        </exec>
    </target>


</project>
