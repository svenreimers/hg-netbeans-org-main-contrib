<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="netbeans" name="contrib/autoproject.java">
    <import file="../../nbbuild/templates/projectized.xml"/>
    <property name="test.user.dir" location="build/testuserdir"/>
    <target name="-build-web-module" if="enterprise.cluster.exists">
        <ant dir="../autoproject.web" target="netbeans"/>
    </target>
    <target name="-build-profiler-module" if="profiler.cluster.exists">
        <ant dir="../autoproject.profiler" target="netbeans"/>
    </target>
    <target name="debug" description="Build related modules and debug them.">
        <ant dir="../autoproject.core" target="netbeans"/>
        <available property="enterprise.cluster.exists" file="../../nbbuild/netbeans/nb.cluster.j2ee.built"/>
        <antcall target="-build-web-module"/>
        <available property="profiler.cluster.exists" file="../../nbbuild/netbeans/nb.cluster.profiler.built"/>
        <antcall target="-build-profiler-module"/>
        <path id="clusters">
            <dirset dir="../../nbbuild/netbeans">
                <include name="extra"/>
                <include name="ide*"/>
                <exclude name="identity*"/>
                <include name="java*"/>
                <include name="gsf*"/>
                <include name="websvccommon*"/>
                <include name="enterprise*"/>
                <include name="profiler*"/>
                <include name="nb*"/>
            </dirset>
        </path>
        <property name="clusters.toString" refid="clusters"/>
        <input message="Clean user directory?" defaultvalue="no" validargs="yes,no" addproperty="clean.userdir.yesno"/>
        <condition property="clean.userdir">
            <istrue value="${clean.userdir.yesno}"/>
        </condition>
        <antcall target="-testuserdir-delete"/>
        <antcall target="projectized.debug">
            <param name="tryme.args" value="
                -J-Dnetbeans.full.hack=true
                -J-Dnetbeans.exception.report.min.level=999999
                -J-Dorg.netbeans.modules.autoproject.level=0
                --clusters ${clusters.toString}
                "/>
        </antcall>
    </target>
    <target name="-testuserdir-delete" if="clean.userdir">
        <ant dir="../../nbbuild" target="testuserdir-delete"/>
    </target>
</project>
